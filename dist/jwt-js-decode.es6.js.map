{"version":3,"file":"jwt-js-decode.es6.js","sources":["../src/jwt-js-decode.ts"],"sourcesContent":["import pako from \"pako\";\r\n\r\n/**\r\n * Pako 1.0.6 has 'from' property which is not included in current version of typeDef @types/pako@1.0.0\r\n *\r\n * @hidden\r\n */\r\ndeclare namespace Pako {\r\n    export interface DeflateOptions {\r\n        raw?: boolean;\r\n        from?: string;\r\n        to?: string;\r\n    }\r\n\r\n    export interface InflateOptions {\r\n        raw?: boolean;\r\n        from?: string;\r\n        to?: string;\r\n    }\r\n}\r\n\r\n/**\r\n * Class for creating a JwtSplit object with three parts of JWT Token as strings\r\n *\r\n * @class  JwtSplit\r\n */\r\nexport class JwtSplit {\r\n    /**\r\n     * Header (first) part of JWT Token\r\n     *\r\n     * @name  header\r\n     * @type {string}\r\n     */\r\n    header: string;\r\n\r\n    /**\r\n     * Payload (second) part of JWT Token\r\n     *\r\n     * @name  payload\r\n     * @type {string}\r\n     */\r\n    payload: string;\r\n\r\n    /**\r\n     * Signature (third) part of JWT Token\r\n     *\r\n     * @name  signature\r\n     * @type {string}\r\n     */\r\n    signature: string;\r\n\r\n    constructor(str: string) {\r\n        if (typeof str !== \"string\") {\r\n            throw new Error(\"Illegal parameter specified!\");\r\n        }\r\n\r\n        const jwtArr = str.split('.');\r\n        if (jwtArr.length !== 3) {\r\n            throw new Error(\"Illegal jwt string!\");\r\n        }\r\n\r\n        const [header, payload, signature] = jwtArr;\r\n        this.header = header;\r\n        this.payload = payload;\r\n        this.signature = signature;\r\n    }\r\n}\r\n\r\n/** JwtPart interface basically object type definition used as a placeholder */\r\nexport interface JwtPart {\r\n    [key: string]: any\r\n}\r\n\r\n/**\r\n * Class for creating a JwtDecode object with three parts of JWT Token, header and payload decoded and parsed, signature in initial form\r\n *\r\n * @class  JwtDecode\r\n */\r\nexport class JwtDecode {\r\n    /**\r\n     * Header (first) part of JWT Token\r\n     *\r\n     * @name  header\r\n     * @type {JwtPart}\r\n     */\r\n    public header: JwtPart;\r\n\r\n    /**\r\n     * Payload (second) part of JWT Token\r\n     *\r\n     * @name  payload\r\n     * @type {JwtPart}\r\n     */\r\n    public payload: JwtPart;\r\n\r\n    /**\r\n     * Signature (third) part of JWT Token\r\n     *\r\n     * @name  signature\r\n     * @type {string}\r\n     */\r\n    public signature: string;\r\n\r\n    constructor(str: string) {\r\n        if (typeof str !== \"string\") {\r\n            throw new Error(\"Illegal parameter specified!\");\r\n        }\r\n        const jwtSplit: JwtSplit = JwtJsDecode.jwtSplit(str);\r\n\r\n        this.header = JSON.parse(JwtJsDecode.bu2s(jwtSplit.header));\r\n        this.payload = JwtJsDecode.isGzip(this.header) ? JSON.parse(JwtJsDecode.zbu2s(jwtSplit.payload)) : JSON.parse(JwtJsDecode.bu2s(jwtSplit.payload));\r\n        this.signature = jwtSplit.signature;\r\n    }\r\n}\r\n\r\nexport class JwtJsDecode {\r\n    /**\r\n     * Converts base64url string to base64 string\r\n     *\r\n     * @param {string} str - data string to convert\r\n     *\r\n     * @returns {string} base64 string\r\n     */\r\n    static bu2b(str: string): string {\r\n        if (typeof str !== \"string\") {\r\n            throw new Error(\"Illegal parameter specified!\");\r\n        }\r\n        if (str.length % 4 === 1) {\r\n            throw new Error(\"Illegal base64url string!\");\r\n        }\r\n\r\n        for (; (str.length % 4 !== 0);) {\r\n            str += \"=\";\r\n        }\r\n        return str\r\n            .replace(/\\-/g, \"+\")\r\n            .replace(/_/g, \"/\");\r\n    }\r\n\r\n    /**\r\n     * Converts base64 string to base64url string\r\n     *\r\n     * @param {string} str - data string to convert\r\n     *\r\n     * @returns {string} base64url string\r\n     */\r\n    static b2bu(str: string): string {\r\n        if (typeof str !== \"string\") {\r\n            throw new Error(\"Illegal parameter specified!\");\r\n        }\r\n        if (str.length % 4 !== 0) {\r\n            throw new Error(\"Illegal base64 string!\");\r\n        }\r\n\r\n        return str\r\n            .replace(/\\+/g, \"-\")\r\n            .replace(/\\//g, \"_\")\r\n            .replace(/=/g, \"\");\r\n    }\r\n\r\n    /**\r\n     * Converts base64url string to string\r\n     *\r\n     * @param {string} str - base64url string to convert\r\n     *\r\n     * @returns {string} decoded data string\r\n     */\r\n    static bu2s(str: string): string {\r\n        return this.b2s(this.bu2b(str));\r\n    }\r\n\r\n    /**\r\n     * Converts string to base64url string\r\n     *\r\n     * @param {string} str - data string to convert\r\n     *\r\n     * @returns {string} base64url string\r\n     */\r\n    static s2bu(str: string): string {\r\n        return this.b2bu(this.s2b(str));\r\n    }\r\n\r\n    /**\r\n     * Converts base64 string to string\r\n     *\r\n     * @param {string} str - data string to convert\r\n     *\r\n     * @returns {string} base64 string\r\n     */\r\n    static s2b(str: string): string {\r\n        return btoa(str);\r\n    }\r\n\r\n    /**\r\n     * Converts string to base64 string\r\n     *\r\n     * @param {string} str - data string to convert\r\n     *\r\n     * @returns {string} decoded data string\r\n     */\r\n    static b2s(str: string): string {\r\n        return atob(str);\r\n    }\r\n\r\n    /**\r\n     * Converts string to gzip data string\r\n     *\r\n     * @param {string} str - data string to convert\r\n     *\r\n     * @returns {string} gzip data string\r\n     */\r\n    static zip(str: string) {\r\n        if (typeof str !== \"string\") {\r\n            throw new Error(\"Illegal parameter specified!\");\r\n        }\r\n        return pako.deflate(str, {\r\n            raw: false,\r\n            from: \"string\",\r\n            to: \"string\"\r\n        } as Pako.DeflateOptions & { to: \"string\" });\r\n    }\r\n\r\n    /**\r\n     * Converts from gzip data string to string\r\n     *\r\n     * @param {string} str - data string to convert\r\n     *\r\n     * @returns {string} decoded data string\r\n     */\r\n    static unzip(str: string) {\r\n        if (typeof str !== \"string\") {\r\n            throw new Error(\"Illegal parameter specified!\");\r\n        }\r\n        return pako.inflate(str, {\r\n            raw: false,\r\n            from: 'string',\r\n            to: 'string'\r\n        } as Pako.InflateOptions & { to: \"string\" });\r\n    }\r\n\r\n    /**\r\n     * Gzip and encode data string to base64url string\r\n     *\r\n     * @param {string} str - data string to encode\r\n     *\r\n     * @returns {string} base64url string\r\n     */\r\n    static s2zbu(str: string) {\r\n        return this.s2bu(this.zip(str));\r\n    }\r\n\r\n    /**\r\n     * Decode from base64url and unzip data string\r\n     *\r\n     * @param {string} str - data string to decode\r\n     *\r\n     * @returns {string} decoded data string\r\n     */\r\n    static zbu2s(str: string) {\r\n        return this.unzip(this.bu2s(str));\r\n    }\r\n\r\n    /**\r\n     * Split jwtToken into object {header, payload, signature}\r\n     *\r\n     * @param {string} str - data string to split\r\n     *\r\n     * @returns {JwtSplit} jwt split object of three strings\r\n     */\r\n    static jwtSplit(str: string): JwtSplit {\r\n        return new JwtSplit(str);\r\n    }\r\n\r\n    /**\r\n     * Check if header has zip property (and it is equal to 'GZIP', ignorecase)\r\n     *\r\n     * @param {string} header - object to check\r\n     *\r\n     * @returns {boolean} does it have gzip in zip property\r\n     */\r\n    static isGzip(header: JwtPart): boolean {\r\n        return typeof header === 'object' && typeof header.zip === 'string' && header.zip.toUpperCase() === 'GZIP'\r\n    }\r\n\r\n    /**\r\n     * Decode jwtToken header and payload\r\n     *\r\n     * @param {string} str - data string to decode\r\n     *\r\n     * @returns {JwtDecode} object with decoded header and body, and signature untouched\r\n     */\r\n    static jwtDecode(str: string): JwtDecode {\r\n        return new JwtDecode(str);\r\n    }\r\n}\r\n\r\nexport default JwtJsDecode;\r\n"],"names":[],"mappings":"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"}